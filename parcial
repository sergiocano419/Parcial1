CREATE TABLESPACE MID_TERM 
DATAFILE 'datafile.dbf' SIZE 20M;

ALTER SESSION SET "_ORACLE_SCRIPT"=true

create profile PARCIAL limit
idle_time 20
failed_login_attempts 2;


CREATE USER SCANO
IDENTIFIED BY SCANO
DEFAULT TABLESPACE MID_TERM
QUOTA unlimited ON MID_TERM;

alter user SCANO profile PARCIAL;

GRANT DBA, create session to SCANO;



CREATE USER USER2
IDENTIFIED BY USER2
DEFAULT TABLESPACE MID_TERM
QUOTA 0 ON MID_TERM;

alter user USER2 profile PARCIAL;

grant create session to USER2;


CREATE ROLE MINI_DBA;

CREATE ROLE STUDENT;

grant create table, create view to MINI_DBA;




/////////////Entity DataBase///////////////////////////////////


CREATE TABLE ESTADOS_PRESTADORES (
  ID INTEGER PRIMARY KEY,
  NOMBRE VARCHAR2(255)    
);

CREATE TABLE MODALIDADES (
  ID INTEGER PRIMARY KEY,
  NOMBRE VARCHAR2(255)
);

CREATE TABLE TIPO_COMUNAS (
  ID INTEGER PRIMARY KEY,
  TIPO VARCHAR2(255)
);

CREATE TABLE COMUNAS (
  ID INTEGER PRIMARY KEY,
  NOMBRE VARCHAR2(255), 
  TIPO_COMUNA_ID INTEGER,
  CONSTRAINT TIPO_COMUNA_FK FOREIGN KEY (TIPO_COMUNA_ID) REFERENCES TIPO_COMUNAS(ID)
);

CREATE TABLE BARRIOS(
  ID INTEGER PRIMARY KEY,
  NOMBRE VARCHAR2(255),
  COMUNA_ID INTEGER,
  CONSTRAINT COMUNA_FK FOREIGN KEY (COMUNA_ID) REFERENCES COMUNAS(ID)
);

CREATE TABLE PRESTADORES(
  ID INTEGER PRIMARY KEY,
  NOMBRE VARCHAR2(255), 
  FECHA_CONTRATACION DATE,
  VALOR_CONTRATO DATE,
  ESTADO_ID INTEGER,
  CONSTRAINT ESTADO_FK FOREIGN KEY (ESTADO_ID) REFERENCES ESTADOS_PRESTADORES(ID)
);

CREATE TABLE SEDES(
  ID INTEGER PRIMARY KEY,
  SEDE  VARCHAR2(255), 
  TELEFONO VARCHAR2(255),
  DIRECCION VARCHAR2(255),
  CUPOS_DISPUESTOS VARCHAR(8),
  BARRIO_ID INTEGER,
  MODALIDAD_ID INTEGER,
  PRESTADOR_ID INTEGER,
  CONSTRAINT BARRIO_FK FOREIGN KEY (BARRIO_ID) REFERENCES BARRIOS(ID),
  CONSTRAINT MODALIDAD_FK FOREIGN KEY (MODALIDAD_ID) REFERENCES MODALIDADES(ID),
  CONSTRAINT PRESTADORES_FK FOREIGN KEY (PRESTADOR_ID) REFERENCES PRESTADORES(ID)
);
